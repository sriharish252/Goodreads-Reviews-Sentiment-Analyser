import requests
from bs4 import BeautifulSoup
import re
import sqlite3
from sqlite3 import Error
from vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer
analyser = SentimentIntensityAnalyzer()

"""    Scraping is disabled for now, since Goodreads has blocked me from scraping due to lots of requests
#Start Scraping using BeautifulSoup
reviewlinks = []
page = requests.get('https://www.goodreads.com/book/show/44581530-dead-astronauts')
soup = BeautifulSoup(page.text,'html.parser')
check = soup.find_all('a',text=re.compile('see review'), limit=10)
for links in check:
    link = 'https://www.goodreads.com'+links.get('href')
    reviewlinks.append(link)
for link in reviewlinks:
    page1 = requests.get(link)
    soup1 = BeautifulSoup(page1.text,'html.parser')
    print(link)
    review = soup1.find(class_='reviewText mediumText description readable')
    #print((review.contents[0])) #This prints only 1st para
    paras = ["".join(x.findAll(text=True)) for x in review.findAllNext("p")] #for multiple paras
    print(paras)
"""


#SQLite
#Create Table Format
create_table = """ CREATE TABLE IF NOT EXISTS reviews (
    bid integer NOT NULL,
    bname text NOT NULL,
    rno integer NOT NULL,
    review text,
    score int
); """

#Create Connection
conn = None
try:
    conn = sqlite3.connect(':memory:')    #(':memory:') To create DB in RAM  #(r"G:\CLG\Internship\GoodreadsReviewSentiment.db")
    print("Database Created")
except Error as e:
    print(e)

#Create Table
try:
    c = conn.cursor()
    c.execute(create_table)
    print("Table Created")
except Error as e:
    print(e)

c.execute('DELETE FROM reviews')
conn.commit()


#Insert data into Table - since Goodreads has blocked me from scraping due to lots of requests
rev=['Life of Pi','life is so beautiful that death has fallen in love with it - a jealous, possessive love that grabs at what it can and sometimes stories are so beautiful that souls have fallen in a love with them - a tender, quiet love that nurtures what it can. this is one of those stories. its a story that will always have a special place in my heart. its one of the only books that has ever made me re-evaluate my beliefs on faith, it helped me further realise the impact and importance of the connection between humans and animals, and it planted a seed of hope that life can be beautiful, even in the most harrowing of circumstances. this is the kind of story that will always teach life lessons, no matter at which age you read it and regardless of the amount of re-reads. you will always walk away from this book having learnt something new about life, the world, and about yourself. it is truly one of the most beautiful stories i have ever had the privilege of reading.',
'Life of Pi','LITTLE INDIAN BOY GOES ON WEIRD BOAT RIDE WITH MEAN CAT.',
'Life of Pi','On the surface, its the story of a 16 year old Indian boy named Pi who, when he and his zookeeping family decide to transplant themselves and some animals to Canada, ends up stranded on a lifeboat with a hyena, a zebra, an orangutan, and a 450-lb Bengal tiger named Richard Parker. Dont let the Rudyard Kipling-ness of the plot fool you! In reality, this book is an examination of faith in all its forms. Young Pi loves God, and to prove it he becomes Christian and Muslim in addition to his native Hinduism. He also loves animals, and much of the book examines animal psychology and its relationship to human psychology in a vibrant, interesting way.  This book had me asking questions about my life, my beliefs, and my society on just about every page....and when the reader gets to the end (which I wont spoil here), the reader is forced to ask themself the kind of person they really are. If ever there was a novel that could be called a litmus test, its this one. The Life of Pi will, at the very least, entertain through its sharp storytelling, but it can also help a reader examine how they see the world - and isnt that the point of great literature?',
'Life of Pi','Its not that it was bad, its just that I wish the tiger had eaten him so the story wouldnt exist. I read half of it, and felt really impatient the whole time, skipping whole pages, and then I realized that I didnt have to keep going, which is as spiritual a moment as I could hope to get from this book.',
'Life of Pi','I loved this book! I watched the film before reading the book and I loved both of them. I enjoy short chapters so this was good for me. Best scene was the 3 religious men arguing about Pis religion. Found it really smartly done and funny.',
'Life of Pi','Sift a pinch of psychology with a scant tablespoon of theology, add one part Island of the Blue Dolphin with two parts philosophy, mix with a pastry blender or the back of a fork until crumbly but not dry and there you have Pi and his lame-o, cheesed out, boat ride to enlightenment. Actually I liked the beginning of this book- loved Pi s decleration and re-naming of himself, his adding religions like daisy s to a chain, and was really diggin on the family as a whole and then....then, then, then the tarpaulin. I did learn some things though, I learned that: a). cookies work wonders in assuaging heated arguments. b). Tiger turds do NOT taste good, no mater how hungry you are and hold absolutely no nutritional value (actualy this might apply only to turds obtained from tigers that have been floating on rafts for several weeks/months? I think I ll apply it as a general rule). I wanted to like this book more - I loved the cover and then there s that little golden seal that keeps going psst, psst, you don t get it - it s waaaay deep, you missed the whole point. But I think no, I got the point, like a 2 by 4 to the forehead I got the dang point! What I lack in spelling, this author lacks in subtlty. I felt like the ending was a study guide/cliff notes pamphlet/wikepedia entry all in one. I love Pi in the first 3rd, I understand the merits of Pi in the raft (just not my thing), but pi in the last bit - ugh, ugh,ugh! I m chocking on the authors shoving of moral down my throat - help! help! I can t breath....... 2 stars for the beginning, negative 3 stars for the ending, add something (or subtract to make it equal a positive - ????) and there you have my 2 starred LIfe of Pi review.',
'Life of Pi','The beginning is rough. It s all like - Why do we keep going on and on about religion? Where s the boat? Where s the tiger? Stop and enjoy the roses. The book will get to the tiger part when it wants to. Young Pi ( Piscine "Pi" Patel ) spends the first part of the book joining the Christian, Muslim and Hindu faiths. It s not a matter of he can t choose a religion - it s that he is able simultaneously believe in all of them. The philosophical musings and religious prose provide an extremely interesting insight on how these religions intersect: If Christ spent an anguished night in prayer, if He burst out from the Cross,  My God, my God, why have you forsaken me?  then surely we are also permitted doubt. But we must move on. To choose doubt as a philosophy of life is akin to choosing immobility as a means of transportation. And then...you get to the tiger part! Pi Patel s life quickly shifts from one of religious philosophy and animal care (at his family s zoo) to one of great uncertainty. His family is closing their Indian zoo and they need to travel by boat to a new county. Whatever animals they couldn t sell or trade are on the ship. Only, something goes wrong. Very. Wrong. The ship is capsizing and it looks like neither human nor animal will make it out alive. Soon, Pi finds himself on a lifeboat with a menagerie of animals and within an adventure he will surely never forget. Dare I say I miss him? I do. I miss him. I still see him in my dreams. They are nightmares mostly, but nightmares tinged with love. Such is the strangeness of the human heart.',
'Life of Pi','I read this book two years ago, but when we discussed it this month for book club, I remembered how much I liked it. A good discussion always ups my appreciation of a novel as does an ending that makes me requestion my givens in the story. I find myself reading contradictory interpretations and agreeing with both sides. That s the beauty of symbolism: as long as you back up your cause, it s plausible. Initially it took me several weeks to get into the book. The beginning reads more like a textbook with inserted clips of the main character s future self. While the knowledge I gained about zoology and theology was interesting, it wasn t intriguing enough to keep me awake for more than a few pages at a time and often I found the tidbits a confusing distraction. But with distance I enjoyed the backdrop information it offered. If you re struggling through the initial background, jump ahead to the second section. Yeah it s important, but it s not vital. And maybe once you ve read the story you ll want to come back and appreciate his analysis. I highly enjoyed this strange journey at sea and found it almost believable--until the castaways encounter the island at which point I wondered how much of his sanity wavered. Being shipwreck is one of a plethora of phobias I have. Throw on top my even stronger fear of tigers and this was a story straight out of a nightmare, one that kept me intrigued for a resolution. How could a boy keep the upper hand shipwrecked with a tiger? I had a picture in my head of Pi clinging to the side of the boat to avoid both the salty water infested with sharks and a foodless boat housing a hungry carnivore. I found myself stuck in the unusual place where as a reader I find a story plausible with full knowledge that had this story been presented in real life I would have doubted its authenticity. I wanted to believe the story and all its fantasy. The end initially annoyed me, but if you look at the rich metaphors in the story, it becomes delectable for a story analyst like me. There is nothing I enjoy more than tearing apart a story and pulling out the intentions and symbols buried inside. Instead of just a fantastical story, you find a fable with a moral.',
'Life of Pi','People often see me walking down the street, casually, minding my own business, and they always stop and ask me, Yo, Justin, what are you reading these days? And I m always happy to stop and engage in conversation about what I m reading, and I share a few thoughts about the book. Yeah, it s not bad. Pretty good so far. Really enjoying it! Better than I expected! Oh man, it s alright I guess. Kinda slow. I like to keep my comments pretty general in nature. Also, that never actually happens to me. Or does it? Anyway, I did tell a few people I was reading Life of Pi and every single one of them said, Oh yeah, isn t that the book about the guy and a tiger on a raft? Because that s what everyone thinks of when they think of Life of Pi. The book about some guy on a boat with a tiger. And they are absolutely right. I mean, if you needed a one sentence synopsis of Life of Pi you would say it s about some dude floating around on a raft or a boat or something with a tiger, and that would be it. You nailed it. Except Pi isn t on a lifeboat with Richard Parker (the tiger) until about halfway through the book. So that synopsis isn t enough because there is so much more going on in Life of Pi. So much more. So let s start with the biggest reason this book gets a coveted five star rating from me: I got to learn all about zoos and the animals that inhabit them. I m kidding, a little, kind of, but the beginning of the book is just fascinating to read. Pi weaves in stories of his childhood with facts about India, religion, animals, zoos, family, and all kinds of other stuff. One scene in particular that I loved was when Pi was trying to determine his religion and the choice that follows. Just humorous, insightful stuff all around, and I forgot all about what the book is really about. I won t remind you. The story moves from all of that stuff, like a memoir I guess, to an adventure story. Now, I m not a huge adventure story kind of guy, but the writing was so engaging and the audiobook narration was so intoxicating that I kept plugging along with all the craziness Pi finds himself in. It gets pretty violent and a little disgusting at times, but you re reading about wild animals and about a guy who is caught in a horrible tale of survival. It s not too bad. Then, the end of the book comes along, and oh my god I can t even tell you about the end of the book. It s awesome though. Just trust me on this one if you haven t read it already. You ve probably read it already. You ve probably seen the movie, too, you awesome person you. Look at you go, all awesome and stuff. I m gonna watch the movie as soon as possible. Looking forward to it. This was a fantastic audiobook that I spent almost a month listening to during my morning commute. Whatever I pop in next has a tough act to follow. January has been a pretty solid month of reading for me. Definitely ended it on a high note. I don t rate books five stars very often because I m am overly critical book critic, but this is a five star read that deserves a little bit of your time.',
'Life of Pi','I m a huge fan of Yann Martel s allegorical story. I read Life of Pi shortly after it had won the Booker, heavily intrigued by the story s improbable premise (boy in lifeboat with Bengal tiger). I was keen to see how the author could pull this off. But pull it off he did, taking me back to a wondrous childhood of adventure tales and fables. And you are welcome to whack me over the head with a leather-bound copy of War and Peace, but I am such a sucker for exotic book covers! Please read the book, don t see the film: Ditto, Captain Corelli.',
'Origin','I just finished the book. It s not the best Robert Langdon book in my opinion but it s entertaining as hell. As always if you are looking for some quality writing this is not the book for you. However I love these books. I love that I can look up a building or a piece of art or a religious organization I never heard of and they are all real. So if that s your cup of tea I would recommend this book for you. Yes Robert Langdon is my guilty pleasure so sue me! I can t wait for this !!!!! I know the critics hate Dan Brown and I know that his name has become a punchline. But still I don t care I like his books. They make me want to take long walks in Florence, Rome, The Vatican and Istanbul. They make me want to spend days exploring museums and admiring the art and architecture. I learn trivial information like the word quarantine comes from the italian word quaranta meaning forty, as all ships were required to be isolated for forty days before passengers and crew could go ashore during the Black Death plague epidemic. Is it high literature? Most certainly not. But it s an intense, fast paced and intriguing book you can t put down which keeps you guessing until the last page. Is that so bad? I m gonna say no. So yes i m gonna read this book and every other book that s gonna be published by Dan Brown in the future.',
'Origin','All right, Danny boy, let s see what you ve got for us this time. Anyone want to take bets on how many times he mentions the Mickey Mouse watch? Man, I hope that thing gets smashed under a garbage truck.',
'Origin','Even though I spent quite some money on this book, I can‚Äôt finish it. That‚Äôs because this book is an exact replica of all of Dan Brown‚Äôs previous books about Robert Langdon and I‚Äôm so bored and frustrated with how unoriginal this is. The same protagonist who finds himself in the same kind of situation and makes the same decisions. The structure of the plot is the same with short chapters that all end on ‚Äúcliffhangers‚Äù, and to top it all off Dan Brown throws in a beautiful female - just like in all of his previous novels about professor Langdon. I feel like Dan Brown wrote this book on autopilot and I‚Äôm not liking it one bit. Even though I‚Äôm not going to finish reading it, I have a pretty good feeling I know how it‚Äôs all going to end. *yawn* I wonder if Dan Brown won‚Äôt find himself losing a lot of fans exactly because of this unoriginality of his - even though he might be hoping for the opposite because in writing what we‚Äôve already been loving for years',
'Origin','I first fell in love with Dan Brown s books when I read Deception Point and Digital Fortress many years ago. I used to get the audiobook CDs from the library and I would listen to them on my commute. His novels kept me completely captivated. Now let s talk about Origin, his latest novel. This is the 5th Robert Langdon novel and it has the same elements of the previous books in the series: a crime in a relevant location such as a museum, a mystery to solve, a beautiful and smart woman that teams up with Robert Langdon and assists him in solving said mystery, conspiracy theories, religious intrigue, and interesting and scientific historical facts. Although some parts were interesting, the novel did not engaged me. The author did not charm me like his previous novels did in the past. I did enjoy the chapters where a character named Winston made an appereance. What was interesting about him? You will have to read to find out, I feel that revealing it might be a spoiler. Overall it was ok, I recommend it to those who have enjoyed his previous Robert Langdon novels.',
'Origin','Dan Brown is the premiere source for edge-of-your-seat thrillers, and Origin doesnt disappoint. This time Robert Langdon finds himself somewhat out of water when a murder ploy involving a futurist atheist and varying religious figures takes a high-tech turn. As always, the secret sauce is Browns ability to incorporate research into the high-stakes adventure. We get some of the classic art history type stuff, but also a lot of forward-thinking technology concepts that truly fascinate. On the positive side, Origin is an impossible-to-put-down thrill ride that masterfully handles mystery to the point that youre desperate to find out what happens. On the negative end, the reveals dont quite equal the substantial build-up, and theres at least one major mystery thats pretty obvious early on. Also--I dont know if its for legal reasons or what--but Brown essentially cites some of his research sources through Langdon, and they are disappointing. Travel blogs and TED Talks come up, for example. I like it better when he plagiarizes and looks like a genius - ha! Overall, the great aspects of the book heavily outweigh a few imperfections. If youre a Dan Brown fan, no need to fear - hes still got it',
'Origin','Well that was quintessential Dan Brown. A literary masterpiece? Of course not, and thats not why I read him. Origin isnt his best. Overwritten in some places, underwritten in others. Premise wasnt as tight as his others but still, fast-paced, exciting, interesting, a bit of armchair travel, a crash course in art/architecture every other chapter, decent food for thought and the added bonus of having Tom Hanks in your head. Not a bad way to spend 24 hours.',
'Origin','I have in the past read a number of Dan Brown books and really enjoyed them, this was as my initial comment suggest, no exception. I suppose because I find the films enjoyable that I naturally see and hear Tom Hanks as I read this book. No bad thing as in a way it makes it more personal. This book I suppose could be classed as formulaic as it is very similar to some of his others, but as I haven‚Äôt read one for many a year I did not suffer in that respect. Yes it has Tom oops I mean Robert and a girl companion running around following clues to solve a mystery, but aren‚Äôt all genres in a way formulaic ? So if you enjoy it, what‚Äôs the problem. And I did enjoy this. The 500 plus pages whizzed by as I soaked up the sun ‚òÄÔ∏è In my view the only reason this enjoyable book was not 5 stars was the fact that 1) they all ARE a little similar and 2) you know things are always gonna work out. That said the research that goes into these books must be tremendous, so serious respect to DB for that and making them all enough dissimilar to be enjoyable and fun.',
'Origin','Damn. Ive broken a cardinal rule; by adding another book. Ive read the first four Langdon novels, which I enjoyed, and cant wait for this to be released.',
'Origin','This was certainly a thought provoking read. Truth be told, I‚Äôm not sure I agree with his theories as they directly go against my personal faith and beliefs. Nevertheless, it was entertaining & brilliantly written.',
'Origin','Origin was an incredible journey into the world of science as one of the worlds leading scientists is about to release findings that will change science forever with the promise to answer the questions comprising the universal mysteries. "These two mysteries lie at the heart of the human experience. Where do we come from? Where are we going? Human creation and human destiny. They are the universal mysteries." Edmond Kirsch has chosen the Bilbao Guggenheim Museum for his stunning revelations as much of the world is watching. Because of the impact on religion, Kirsch had previously met with the leaders of the three major religions, so that they had the opportunity to preview his findings. What transpires that evening at the Guggenheim keeps you riveted to the tale as it unfolds with chaos rampant threatening the revelation. Robert Langdon, Harvard professor and former teacher of Kirsch, joins with the Ambra Vidal, director of the Guggenheim Museum, as they race around Spain attempting to unlock the mysteries of Kirschs findings and ensure its release which takes us to some of the most iconic places in Barcelona, as well as some of the most famous works by Spains famous architect, Antoni Gaudi, namely Sagrada Familia and Casa Mia. I loved this book on many different levels.',
'Atonement','That I can remember, Ive never before disliked the start of a book so thoroughly, and by the end, gone on to think so much of it as a complete work. The last 2/3 of this novel are as good as contemporary fiction gets. The first 1/3 is like reading a Jane Austen plot trapped in amber. As the title indicates Atonement is about a future artists massive effort to redeem herself for ruining the character of a young man when she is a younger girl. There are parts of this novel that are disjointed - or if they arent they appear so because the opening act moves so slowly that one is barely conscious and later unable to recall that anything much happened at all. Halfway through this novel, when its greatness starts to happen, a reader almost laments his earlier opinions of it. But whose fault is that? The beginning is such an act of endurance that the later parts make a reader wish that McEwan had moved things more quickly in the beginning - and used those words for more character development in the middle - so the reader could declare this novel, unequivocally, one of the five best novels hes ever read. McEwan is at the top of the art form throughout, though, whatever a reader opines of the product. He knows what hes doing every step of the way, right down to an allusion to the disjointed narrative methods employed by Virginia Woolf. The ending is brilliant, unexpected and harsh. But unlike the case of the returning Baxter character in the third act of Saturday, this ending is consistent and at once surprising and inevitable. After a person has read a few hundred novels, he grasps the art form well enough to know when an author is writing - usually its when the authors employing some top-heavy descriptive technique that makes the water droplets gathered on a rose petal somehow more important than the protagonists motives for anything shes done to that point - and it fairly well cries out, Look at me, my creator is a writer! Knowing when an author is writing means knowing that if theres a surprise coming, its either going to be predicted about 50 pages out or done in such fantastically poor form that its inconsistency mars the rest of the work. McEwan is fine enough at his craft that the ending is both unanticipated and perfectly consistent. That alone makes this novel excellent.',
'Atonement','I was bored with this until half way through, but then it got interesting. It touches on imagination versus reality, fiction versus fact, in addition to the story content. A portrait of an upper middle class English family is interrupted by a supposed rape in which a young imaginative (vengeful) girl misidentifies the rapist. I found that it stayed with me and that I appreciated it more with time. The film was a magnificent translation.',
'Atonement','What a lovely reread this was! I first read this novel almost a decade ago, and the story has stayed with me. The prose is gorgeous, and again I was completely absorbed in this novel. My favorite character is Briony, the young writer seeking atonement for a mistake she made as a child. And my heart aches for her sister, Cecilia, and her wronged lover, Robbie. Ive only read a few of McEwans books, but I like his writing style so much I want to read more. Highly recommended.',
'Atonement','Having already seen the movie, I didnt particularly want to read the book (Ive never read Mario Puzos The Godfather, now have I?), but seeing as this book is a modern great, I felt it my duty to drag it from my book cave. Pleasingly, McEwan writes with aplomb about the human psyche: of lust, loathing, immaturity and guilt; his prose is word perfect. That said, the novel suffers from its own identity crisis, a mezze of Jane Austen, followed by a main course of Sebastian Faulks. The authors genius, though, is in causing us to forget that his book was actually written in the modern day. Very clever! One of our protagonists, Robbie, puts his lustful thoughts to paper in a way that would merely seem vulgarly juvenile in a modern day text message: Been dreamin bout kissing your cunt, yeah? But, when inscribed in ink, onto 1930s vellum-finish stationery? Well naturally the C word amps up the shock factor exponentially!',
'Atonement','In life, we all make mistakes. Some big, some small, but usually we quickly forget them. But what happens when you make a mistake that haunts you every day and you can do nothing about it? This book was fantastic. I loved the writing. I loved the characters. They were so well developed I could feel their emotions in myself as I read. I was deeply and truly satisfied by the story and the writing. When I closed the book after the last page I felt like I was sitting back after finishing an amazing meal. Read this! It is going up on my favorites shelf',
'Atonement','This book...I hate it! Its beautiful, every word of it is gorgeous, but its as if the author spends all this time painstakingly crafting a really detailed, intricate vessel for you (Im thinking of a boat :))and then just before your journeys over he snatches it out from under you & you sink. Why go to such lengths describing the lovers, and the war, and Briony & the nursing when in the end none of it even matters? The problem with Atonement is that there is no atonement, which, of course, is the point. This book was described to me as haunting and it definitely is- haunting & depressing. A story doesnt have to have a happy ending to be good, I mean, this is a great book, really, but I felt really empty & hollow when it was over. The part at the end when the author says that the story is the only part that matters b/c no one will ever remember the real people or the actual events anyway was crushing! Its true, I know, and I dont really have a problem w/ realism...but I have a big problem with death. It freaks me out. I have a really unhealthy fear of it. Especially unjust death. It just pisses me off more than I can explain. Maybe Ive just been feeling too poetic lately, listening to too much sensitive-artist music, but I cant stand that Briony kills 2 people and then just conjures them back up from the dead as if it never happened and no one else even mentions it. It makes me think too much about actual events, politics, & things. I dont want to run out of time, I have things I want to do here, and I dont want to be reminded that the truth is it doesnt matter whether I run out of time or not because eventually there isnt going to be anyone left who ever knew me, or my family, or anyone we ever knew. Ugh. Im making myself sick w/ this. Im told the movie is really good b/c its beautiful w/out being quite as harsh at the end. I think I need to see it so I can stop thinking about the book. Its waking me up at night, or rather its waking me up in the morning realizing that Ive been thinking about it all night. I hate it, but it really is good.',
'Atonement','I think its perfectly fine for any mature enough kid to watch a movie like this. (Maybe not with their parents, how awkward would that be?) Chances are theyve already encountered words like c**t, and its only type written so its not even that bad. I saw this movie . I didnt really like the gruesome army scenes and this movie was just a bit depressing, since the ending wasnt necessarily happy. Other then that I thought the acting was phenomenal and I especially thought the character of Briony was really interesting and compelling.',
'Atonement','This was the favourite novel of a friend of mine who died suddenly a few years ago. She loved it so much that she refused to see the film adaptation because, she said, it couldnt possibly be as good as the novel. I, on the other hand, saw the film without having read the book because when the film was released I was still in the wont-read-McEwan stage of my life that lasted from 1988 or 1989 until two or three years ago. Anyway, I quite liked the film, or at least it made an impression on me at the time. Although Ive only seen it once, I can still see images: Cecilias green dress and the beach at Dunkirk particularly come to mind. I also remembered the plot, and therefore its twist. So when I read the novel, there were no suprises. Knowing what was going to happen, I paid attention to see if I could pick up the clues and yes, they were there in the text. Not that I think a reader who didnt know the plot could work it all out just on the basis of the clues, but at least McEwan wasnt cheating. Anyway, while I dont think McEwan is ever going to be my favourite novelist. Theres a brittleness to him (or something, Im not quite sure what it is) that I find unappealing. However, in this novel he poses important questions about love, guilt, redemption, truth and the nature and purpose of fiction. McEwan writes excellent prose and he does the meta-fiction thing extremely well. I doubt Ill be reading this again, but Im glad that Ive read it once. Now I understand why my friend loved it so much. I just wish she was still here so we could talk about it.',
'Atonement','I watched the movie before reading the book, which was probably a mistake because I loved the movie and I felt that the book didnt measure up. Which is unfair, I know, but there it is! What impressed me about the book was the powerful statement the author is making on the power of narrative - how much it rules our lives. It does not matter whether it is true or false: in fact, true or false has no say in it, because for each one of us it is entirely subjective. And when the person in question is a writer, sometimes the narrative proves too powerful for herself to control. This is what happens to Briony Tallis. As a pre-teen, she unleashes forces larger than herself which play havoc with the lives of her near and dear. Forces she cannot contain, however much she tries. What remains is... Atonement.',
'Atonement','Wow, this book was really good but on different levels. The first half gives us an intense story about a family who lives in some kind of a mansion in England. Briony, Cecilia and the other family members are peculiar characters that give you a feeling that trouble is stirring under the surface. The second half of the book takes a turn for the more serious, and while this part had its enchanting moments, it was the first part I loved the most. Maybe its because Ive watched the movie (which seems to follow only the first part of this novel). Things wrap up beautifully and leaves you with a feeling of being cheated of the truth. I liked it a lot and found Ian McEwans story-telling compelling and highly interesting.',
'Short','Nuts. I loved Sloans COUNTING BY 7S, and I thought this book would be amazing based on the description...but I just thought it was okay. There was something about the voice of the young protagonist. I could tell she was supposed to be quirky and funny, but it didnt always play that way for me... Still an enjoyable read, just not as good as I wanted it to be',
'Short','I liked this book better when I started reading it than when it ended. After the middle, this book started to drag a lot for me, and I found myself forcing myself to see it through. The big issue is that Julia has a great voice, but after a while it got tiresome--mostly because Julia spends most of the book in her head. Also, I realize this isnt the story Sloan set out to tell, but I would have probably liked this a lot better if Julia had actually interacted with some kids her own age so I got to see her actually being a kid instead of the mini-adult she thought she was.',
'Short','Endearing novel seen through the eyes of the oh so charming preteen Julia Marks. Discouraged about her lack of stature and grieving the loss of her beloved dog, Ramon, Julia isnt looking forward to her summer. Her life changes dramatically (no pun intended) when her mother signs her and younger brother, Randy up as Munchkins in a semi-professional production of The Wizard of Oz. During the course of the nearly daily rehearsals Julia is introduced to the world of theatre and a quirky cast of characters who leave a lasting impact on her young life. Had I read this as a child it would have undoubtedly been one of my favorites. Ive long loved the theatre and would have enjoyed Julias astute, raw observations about the world around her.',
'Short','A girl who is short, doesnt want to he short, gets cast in play to be short, and learns that being short is a very tall order and she is ready to tackle it. Wizard of OZ meets realistic fiction. Loved it!',
'Short','I think Sloan is a super writer so (in addition to the good reviews Id read) I fully expected to enjoy this. I thought this was super. I loved the frank age-appropriate voice of Julia as she observed the world around her and did not get everything. Its tricky to write a child character whos not too preciously precocious and savvy, but can talk about feelings, and I think Sloan did an amazing job of it. I loved seeing things through Julias eyes, including how a play gets produced, what it feels like to be part of a cast, discovering how interesting her neighbor was, and observing a possible adult romance. I thought this was funny and refreshing and look forward to putting this into the hands of my students! I especially want to recommend it to my daughters 4H group who will be performing The Wizard of Oz this summer and, just like Julia, my daughter gets to be a Munchkin and a winged (not flying) monkey! (though she wont get to fly.)',
'Short','I enjoyed this. I think I wouldve enjoyed this more had I read it with my eyes. I dont generally enjoy Sands young voices. They tend to come off too quirky for my taste. I loved Julias meandering self-centeredness.',
'Short','3.5 stars. I feel like the voice of this character would be hard for many ofy students to enjoy. Julia is a very sweet girl who goes through a fun, life-changing summer, but Im not sure how relatable her voice/character is... I can only think of maybe three students from my *short* teaching career that would relate to Julia. Still a very sweet book. I would recommend it to students, but only a select few. There are also some references and events that I think would go over the heads of many students- they were a bit advanced I think for 4th/5th graders.',
'Short','Ive been looking for read alouds with unrepresented characters and this one qualifies. Ive loved Holly Goldberg Sloans writing since I discovered her in Counting by 7s. This one was right up there. So many great lines.',
'Short','I grew this summer. Not on the outside, but on the inside. And thats the only place where growing really matters. Short by Holly Goldberg Sloan features Julia Marks, a matter-of-fact girl who does not like people referring to her as short. In fact, she has banned the word from her vocabulary. To make matters worse, her mother is forcing her to try out for the theater production of The Wizard of Oz, and what does she get casted as? Thats right, a munchkin. Plus, her two best friends are gone for the summer, she may need to get braces, and her dog, Ramon, passed away a few months ago. Talk about wanting the summer to be over before it even starts. Will Julia follow the yellow brick road and find new friendships, new experiences, and a new hobby? Short was a fun read full of drama/theater references, energetic characters, and a few fantastic flying (winged) monkeys! üé≠üë†üêµ',
'Short','I liked this book! It was a sweet story of Julia and the summer she spends playing a Munchkin in her towns production of The Wizard of Oz. There were some very funny moments and observations made by Julia and overall, it was a good story. Great for those middle grade kids who like realistic fiction without any edgy parts whatsoever.',
'IT','I read this entire book in one day during my 24-hour readathon. I highly enjoy Stephen Kings descriptive writing style! I was on the edge of my seat for the majority of the novel, and I definitely did not sleep well the following night! However, I hate his constant use of slurs against black, Jewish, and gay characters. I understand that he is using them as a tool to highlight the real horrors in our everyday lives, but it was 100% not necessary to use them with such frequency. Also, TW for sexual assault, domestic abuse, and suicide.',
'IT','Fuck you, Stephen King. WHY WOULD YOU DO THIS TO US?',
'IT','Throughout the book, I was going to give it 4 stars. It was suspenseful, there was a sense of dread with some truly scary scenes. King is very good at describing how children would think and make us feel their fears. It was really long with A LOT of descriptions but it was still very enjoyable. The ending totally ruined it for me...',
'IT','This is one of the essential King reads - it is quite a big one, though! I once heard that Stephen King felt he shoved so much into it he should have called it shIT - (cant remember where I read that and I cannot find the reference at the moment, so maybe this is just a really cool myth) I read this book years ago - I was in my early teens - so I was not much older than the main characters. Because of that, I think the terror was more real. I also remember that this book had some of the most terrifying and heart-wrenching scenes I have ever read. (view spoiler) I will say that the one element of it that struck me as odd and that I still scratch my head at today is the (view spoiler). It was a bit uncomfortable and gratuitous. I may not recommend that you start with this book if you are interested in King. But, if you believe you have reached the point of becoming a King fan and have not read this yet - you really should!',
'IT','This was a ride! This is a huge book, but if you consider to read it, it is definitely worth your time. Of course, it is very well written with a lot of description, which was sometimes hard to go through, but it didn‚Äôt ruin the experience. The story itself is layered and complex and everything happens for a reason and that is very important for a book like this to have that. It is definitely an interesting and captivating story. Two stories (timelines) compliment each other and it isn‚Äôt hard to follow them at the same time. The characters are fleshed out and you can get a good grasp of their motivations and why they are in one way or another. At first, I personally thought that this book will be a little bit different, but actual content didn‚Äôt disappoint. Stephen King is king of horror for a reason.',
'IT','Derry, Maine seems like any other small town in the US except for its dark history. Death and disappearances are the norm and every 27 years they peak as more and more children are killed. When Bills brother Georgie is killed by It, the mysterious thing behind Derrys darkness, Bill sets out to find it. Bill becomes part of a group of other children, all who have had run ins with It and together they get rid of It. They swear an oath to return to Derry if It ever comes back and starts killing and 27 years later they all return to face down It and try to get rid of It once and for all. Dont read past this point because I cant promise anything about no spoilers. I finally finished this god damn tome of a book, and I really wish I werent so compulsive and obsessive about finishing every book I start because wow that was 1400 pages and I couldnt get into the story at all. Also I have a few questions and I feel like I may have missed something so if someone could answer these questions I would appreciate it and maybe then I might feel better about the book. First off its mentioned that none of gang have children and its alluded to as being part of what happened the first time with It but I didnt understand what that had to do with anything? Was there an actual explanation to this or was it just supposed to be there to be ~creepy~. Second why did they have to go out of their way to find It and get rid of it that first time, if It has cycles of 27 years wouldnt It eventually just have stopped on its own anyways because theres no way someone banished it every time it appeared because theyre supposedly the only ones to have done so. Lastly what was the point of them having sex in the sewer, Im not a prude but having 12 year olds do it in the sewer should have a better explanation than to bring them all together and bond them. I dont see how they had to do at all did he just put that in there to be outrageous because good job it worked. At times I did enjoy the book but it was just really long with so many characters and details and a lot of the time I felt myself getting bored like I didnt need such exact descriptions of the boat flowing down the sewer and the way it kept cutting back and forth especially towards the end between past and present just felt choppy and maybe that was the point but it just made me not get really into the book. When I read horror I have to lose some self awareness and get pulled in so I can be creeped out but the whole time I was too aware that I was reading a book and I just kept feeling like it wasnt scary at all. Especially with It morphing constantly like werewolves dont freak me out so I was just like wow a werewolf thats cool I guess. I do like Stephen King and he writes very well but this one just did not work for me and I guess I just missed something because everyone else seems to have really enjoyed this book.',
'IT','With a deep sigh, she closes the book and steals a glance at the clock. its barely 10pm and she knows its already beginning. she can feel it in the way her body tenses at every noise that threatens the peaceful quiet. its in the way her heart skips a beat at every floating movement she swears she sees, just beyond her periphery. its the onset of fear. how silly she is for reading a horror book at such an hour! ‚Äòyou knew this would happen, with your overactive imagination,‚Äô she scolds herself. her only consolation is by already being tucked into the comforting warmth of her bed. she melts further beneath the covers, wondering how long its physically possible for a person to go without sleep. for in sleep, the fears become real. for in sleep, nightmares thrive. so she lays there, too terrified to close her eyes. she becomes acutely aware of every shift in the darkness, the shadows dancing in delight across the walls. and shes convinced they begin to merge into the shape of a clown‚Ä¶ her phone pings suddenly. in the silence of the night, the sound is as harsh as a balloon popping beside her. she flinches. she gasps. in the distance, sirens. she resigns herself for a long night.',
'IT','Thirty some odd years after my first reading of this book and It is still one of the best stories ever told. Ive read this book 15 to 20 times, and every time I think its probably going to be so out dated that Ill never read it again. Not true. If you can read this wondrous tale and not be reminded of the best times of your childhood and the best friends ever, then youve got a heart of stone. It is scary, of that theres no doubt, but mostly its just magical. With every new reading I discover something new that I missed or didnt pay much attention to in the previous readings. This time I fell in love, all over again, with Eddie. I know Richie is suppose to be the funny one, beep, beep, Richie, but Eddie had me laughing my bum off. I always leave this small world of Derry, Maine with a very distinct picture of what the town looked like, and who the people are. Mr. King kind of rocks when it comes to his characters. I again leave this town and these wonderful and dreadful people with a sense of the bittersweet. Knowing that in another year or two Ill be visiting again. Yep, Id highly recommend this book.',
'IT','Be true, be brave, stand Im astonished, what a book! We all float... You want scary? Pennywise is here and hell scare the be-Jesus out of you every other page. Pennywise made an entire generation scared of clowns when the film came out, kinda topical now that all these assholes are roaming the streets in clown outfits. Suffice to say Im extra scared to go for a walk! Above all, the best thing about this book is that its wonderful. King manages to capture the essence of childhood and what it means to have a close group of friends. Its quite similar to Boys Life in that respect. I was a tad reluctant to read this having watched the film and due to the 1376 pages (which took me over a month to read!!) but it was absolutely worth it. The ending, I think is better and there is, naturally, more story. The way its written also highlights how talented a writer King is. He seemlessly jumps from kids to adults throughout. I doubt anyone could have pulled this off as clearly and as beautifully as King does. Although genuinely horrifying, this book captures childhood wonder perfectly and receives all the stars. King at his very best, I know its a bit of a doorstop but its worth it, trust me!',
'IT','this freaked me out so bad and it is only the beginning of October']

ctr = 0
c = conn.cursor()
for i in range(5):
    for j in range(10):
        c.execute('''INSERT INTO reviews(bid,bname,rno,review,score) VALUES(?,?,?,?,?)''',(i+1,rev[ctr],j+1,rev[ctr+1],'None'))
        ctr=ctr+2
print("Rows Inserted")
conn.commit()   #To make changes permanent by stating that this is an end of the Transaction

def sentiment_analyzer_scores(sentence):
    sentiment_score = analyser.polarity_scores(sentence)
    sentiment_score = sentiment_score['compound']*(9/2)+(11/2) #Normalizing to 1 to 10
    return sentiment_score

print("\nInitial Values\n")
c1 = conn.cursor()
c.execute('''SELECT * FROM reviews''')
for row in c:
    # row[0] returns the first column in the query (bid), row[1] returns bname column.
    print(('{0} : {1}, {2} : {3}, {4}'.format(row[0], row[1], row[2], row[3], row[4])).encode('utf8'))
    sentiment_score = sentiment_analyzer_scores(row[3])
    c1.execute('''UPDATE reviews SET score=? WHERE bid=? AND rno=?''',(sentiment_score,row[0],row[2]))

#Final Output
print("\n\nOUTPUT:\n")
c.execute('''SELECT * FROM reviews''')
for row in c:
    # row[0] returns the first column in the query (bid), row[1] returns bname column.
    print(('{0} : {1}, {2} : {3}, {4}'.format(row[0], row[1], row[2], row[3], row[4])).encode('utf8'))

conn.commit()
conn.close()
